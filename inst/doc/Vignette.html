<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Xinying" />

<meta name="date" content="2022-10-05" />

<title>Lilikoi V2.0</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Lilikoi V2.0</h1>
<h4 class="author">Xinying</h4>
<h4 class="date">2022-10-05</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Previously we developed Lilikoi, a personalized pathway-based method
to classify diseases using metabolomics data. Given the new trends of
computation in the metabolomics field, here we report the next version
of Lilikoi as a significant upgrade. The new Lilikoi v2.0 R package has
implemented a deep-learning method for classification, in addition to
popular machine learning methods. It also has several new modules,
including the most significant addition of prognosis prediction,
implemented by Cox-PH model and the deep-learning based Cox-nnet model.
Additionally, Lilikoi v2.0 supports data preprocessing, exploratory
analysis, pathway visualization and metabolite-pathway regression. In
summary, Lilikoi v2.0 is a modern, comprehensive package to enable
metabolomics analysis in R programming environment.</p>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;lilikoi&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lilikoi)</span></code></pre></div>
<p>For certain functions, users need to install packages “M3C”,
‘princurve’ and ‘pathview’ by themselves.</p>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">lilikoi.Loaddata</span>(<span class="at">file=</span><span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;plasma_breast_cancer.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;lilikoi&quot;</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Metadata <span class="ot">&lt;-</span> dt<span class="sc">$</span>Metadata</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>dataSet <span class="ot">&lt;-</span> dt<span class="sc">$</span>dataSet</span></code></pre></div>
</div>
<div id="transform-the-metabolite-names-to-the-hmdb-ids-using-lilikoi-metatopathway-function" class="section level2">
<h2>Transform the metabolite names to the HMDB ids using Lilikoi
MetaTOpathway function</h2>
<p>Lilikoi allows the user to input any kind of metabolite IDs including
metabolites names (‘name’) along with synonyms, KEGG IDs (‘kegg’), HMDB
IDs (‘hmdb’) and PubChem IDs (‘pubchem’). If the metabolites have a
standard names as ID, Lilikoi will match these names among 100 k saved
database, if there are not any hits, Lilikoi will perform fuzzy matching
to find the closest matching for this metabolite.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>convertResults<span class="ot">=</span><span class="fu">lilikoi.MetaTOpathway</span>(<span class="st">&#39;name&#39;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Metabolite_pathway_table <span class="ot">=</span> convertResults<span class="sc">$</span>table</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Metabolite_pathway_table)</span></code></pre></div>
</div>
<div id="calculate-the-pathway-dysregulation-score" class="section level2">
<h2>Calculate the Pathway Dysregulation score</h2>
<p>A specific pathway dysregulation score (PDS) is inferred to measure
the abnormity for each sample in each pathway. For each pathway, the
samples are mapped in a high dimensional principal component space and a
principal curve is constructed along the samples and smoothed. The PDS
score measures the distance from the projected dot along the curve to
the centroid of normal samples (origin point of the curve).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>PDSmatrix<span class="ot">=</span><span class="fu">lilikoi.PDSfun</span>(Metabolite_pathway_table)</span></code></pre></div>
</div>
<div id="select-the-most-signficant-pathway-related-to-phenotype." class="section level2">
<h2>Select the most signficant pathway related to phenotype.</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>selected_Pathways_Weka<span class="ot">=</span> <span class="fu">lilikoi.featuresSelection</span>(PDSmatrix,<span class="at">threshold=</span> <span class="fl">0.50</span>,<span class="at">method=</span><span class="st">&quot;gain&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>selected_Pathways_Weka</span></code></pre></div>
</div>
<div id="data-preprocessing" class="section level2">
<h2>Data preprocessing</h2>
<p>Lilikoi v2.0 enables users to perform three normalization methods
(standard normalization, quantile normalization and median-fold
normalization) and imputation for missing metabolic expressions.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard Normalization</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lilikoi.preproc_norm</span>(<span class="at">inputdata=</span>Metadata, <span class="at">method=</span><span class="st">&quot;standard&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lilikoi.preproc_norm</span>(<span class="at">inputdata=</span>Metadata, <span class="at">method=</span><span class="st">&quot;quantile&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lilikoi.preproc_norm</span>(<span class="at">inputdata=</span>Metadata, <span class="at">method=</span><span class="st">&quot;median&quot;</span>)</span></code></pre></div>
<p>We also implemented imputation function using the K-Nearest Neighbors
method.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># KNN Imputation</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lilikoi.preproc_knn</span>(<span class="at">inputdata=</span>Metadata,<span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;knn&quot;</span>))</span></code></pre></div>
</div>
<div id="exploration-analysis" class="section level2">
<h2>Exploration analysis</h2>
<p>The exploration analysis in lilikoi v2.0 performs source of variation
analysis with the metabolites data frame and demographic data frame
provided by users. Users can choose to implement Principal Component
Analysis(PCA) to extract the most important information in
high-dimensional datasets and the t-SNE plot to visualize the
metabolites data. The PCA and t-SNE plots can be enabled by setting
those flags values to TRUE.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lilikoi.explr</span>(data, demo.data, <span class="at">pca=</span><span class="cn">TRUE</span>, <span class="at">tsne=</span><span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="machine-learning" class="section level2">
<h2>Machine learning</h2>
<p>We include deep learning for classifciation in this version of
lilikoi based on the h2o package.It used multi-layer Neural Network and
Stochastic Gradient Descent to predict the diagnosis results. In order
to reduce redundancy in setting parameters, we only open the
configuration for general machine learning setting. If users want to
change the settings of the deep learning feature, they would need to
change it in the source code.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lilikoi.machine_learning</span>(<span class="at">MLmatrix =</span> Metadata, <span class="at">measurementLabels =</span> Metadata<span class="sc">$</span>Label,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">significantPathways =</span> <span class="dv">0</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">trainportion =</span> <span class="fl">0.8</span>, <span class="at">cvnum =</span> <span class="dv">10</span>, <span class="at">dlround=</span><span class="dv">50</span>,<span class="at">nrun=</span><span class="dv">10</span>, <span class="at">Rpart=</span><span class="cn">TRUE</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">LDA=</span><span class="cn">TRUE</span>,<span class="at">SVM=</span><span class="cn">TRUE</span>,<span class="at">RF=</span><span class="cn">TRUE</span>,<span class="at">GBM=</span><span class="cn">TRUE</span>,<span class="at">PAM=</span><span class="cn">FALSE</span>,<span class="at">LOG=</span><span class="cn">TRUE</span>,<span class="at">DL=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="prognosis-prediction" class="section level2">
<h2>Prognosis prediction</h2>
<p>Prognosis prediction is enabled in Lilikoi v2. It is implemented in
both metabolite level and pathway level with Cox-PH model or Cox-NNET
model. Users should provide vectors of survival results and survival
time. “percent” automatically split the dataset to be training and
testing datasets. “alpha” gives users choices for Lasso, Ridge or
Elastic net penalizations. “nfold” indicates the fold number for cross
validation. “cvlambda” determines the lambda for prediction,
“lambda.min” or “lambda.1se”. “method” determines the prognosis index,
“quantile”, “quantile” or “ratio”.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up prognosis function arguments</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Before running Cox-nnet, users need to provide the directory for python3 and the inst file in lilikoi</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>path <span class="ot">=</span> <span class="fu">path.package</span>(<span class="st">&#39;lilikoi&#39;</span>, <span class="at">quiet =</span> <span class="cn">FALSE</span>) <span class="co"># path = &quot;lilikoi/inst/&quot;, use R to run</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>path <span class="ot">=</span> <span class="fu">file.path</span>(path, <span class="st">&#39;inst&#39;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>python.path <span class="ot">=</span> <span class="st">&quot;/Library/Frameworks/Python.framework/Versions/3.8/bin/python3&quot;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>event <span class="ot">=</span> jcevent</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>time <span class="ot">=</span> jctime</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>percent <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>exprdata <span class="ot">=</span> exprdata_tumor</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>nfold <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>method <span class="ot">=</span> <span class="st">&quot;quantile&quot;</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>cvlambda <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>coxnnet <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>coxnnet_method <span class="ot">=</span> <span class="st">&quot;gradient&quot;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lilikoi.prognosis</span>(event, time, exprdata, <span class="at">percent=</span>percent, <span class="at">alpha=</span><span class="dv">0</span>, <span class="at">nfold=</span><span class="dv">5</span>, <span class="at">method=</span><span class="st">&quot;quantile&quot;</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">cvlambda=</span>cvlambda,<span class="at">python.path=</span>python.path,<span class="at">path=</span>path,<span class="at">coxnnet=</span><span class="cn">TRUE</span>,<span class="at">coxnnet_method=</span><span class="st">&quot;gradient&quot;</span>)</span></code></pre></div>
</div>
<div id="pathway-level-analysis" class="section level2">
<h2>Pathway level analysis</h2>
<div id="pathview-plot" class="section level3">
<h3>Pathview plot</h3>
<p>The selected pathway features from classification pf prognosis
prediction can be visualized in Lilikoi. Any KEGG pathway can be used as
the inout to render pathway graphs. “metamat” is the metabolites
expression data matrix. “sampleinfo” is a vector of sample group, with
element names as sample IDs. “grouporder” is a vector with 2 elements of
reference and experimental group names.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>metamat <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(Metadata[, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>metamat <span class="ot">&lt;-</span> <span class="fu">log2</span>(metamat)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>sampleinfo <span class="ot">&lt;-</span> Metadata<span class="sc">$</span>Label</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sampleinfo) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Metadata)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>grouporder <span class="ot">&lt;-</span> <span class="fu">unique</span>(Metadata<span class="sc">$</span>Label)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lilikoi.KEGGplot</span>(<span class="at">metamat =</span> metamat, <span class="at">sampleinfo =</span> sampleinfo, <span class="at">grouporder =</span> grouporder,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pathid =</span> <span class="st">&#39;00250&#39;</span>, <span class="at">specie =</span> <span class="st">&#39;hsa&#39;</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">filesuffix =</span> <span class="st">&#39;GSE16873&#39;</span>, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Metabolite_pathway_table =</span> Metabolite_pathway_table)</span></code></pre></div>
</div>
<div id="metabolites-pathway-relationship" class="section level3">
<h3>Metabolites-pathway relationship</h3>
<p>We use single variate regression to reveal the relationship between
pathways and their corresponding metabolites. All pathway features and
their significantly associated metabolites are visualized by a bipartite
graph with Cytoscape style.</p>
<p>Before running this function, users need to download Cytoscape from
<a href="https://cytoscape.org/download.html" class="uri">https://cytoscape.org/download.html</a>. Keep Cytoscape
running, then you can connect to R package RCy3. For more info, please
refer to vignettes of RCy3. If run multiple times, there will be
notifications from Cytoscape asking you to overwrite the former
graph.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lilikoi.meta_path</span>(<span class="at">PDSmatrix =</span> PDSmatrix, <span class="at">selected_Pathways_Weka =</span> selected_Pathways_Weka, <span class="at">Metabolite_pathway_table =</span> Metabolite_pathway_table)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
